// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "mysql"
  url      = env("DATABASE_CONNECTION_STRING")
}

model SpecialCondition {
  id                 Int                            @id @default(autoincrement())
  name               String
  description        String
  locale             String                         @default("en")
  difficultyGrade    Int                            @default(0)
  modifications      SpecialConditionModification[] @relation("SpecialConditions")
  excludedTrials     SpecialConditionsOnTrials[]
  excludedConditions SpecialCondition[]             @relation("ConflictingConditions", references: [id])
  excludedBy         SpecialCondition[]             @relation("ConflictingConditions", references: [id])
  translations       SpecialCondition[]             @relation("SpecialConditionTranslation")
  mainConditionId    Int?
  mainCondition      SpecialCondition?               @relation("SpecialConditionTranslation", references: [id], fields: [mainConditionId])
}

model SpecialConditionModification {
  id                 Int              @id @default(autoincrement())
  text               String
  specialCondition   SpecialCondition? @relation("SpecialConditions", fields: [specialConditionId], references: [id])
  specialConditionId Int?
}

model SpecialConditionsOnTrials {
  specialConditionId Int
  specialCondition   SpecialCondition @relation(fields: [specialConditionId], references: [id])
  trialId            Int
  trial              Trial            @relation(fields: [trialId], references: [id])

  @@id([specialConditionId, trialId])
}

model Trial {
  id                Int                         @id @default(autoincrement())
  name              String
  difficultyGrade   Int                            @default(0)
  specialConditions SpecialConditionsOnTrials[]
}
